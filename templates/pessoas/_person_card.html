{# satilo/templates/pessoas/_person_card.html #}
{# Recebe 'person_data' que é o dicionário de dados da pessoa #}
{% load custom_filters %} 

<div class="card person-card-inner-content h-100 border-0 {% if person_data.is_user_selected %}is-user-selected-card{% endif %}"> 
    <div class="card-body d-flex flex-column align-items-center py-2 px-1">
        {# A URL da foto já vem preparada da view (views.py -> _get_person_data), #}
        {# contendo a foto da pessoa ou 'sem-foto.jpg' #}
        <img src="{{ person_data.foto_url }}" alt="{{ person_data.nome }}" class="img-fluid rounded-circle mb-1" style="width: 70px; height: 70px; object-fit: cover; border: 3px solid #ddd;">
        
        <h5 class="card-title name text-center mb-0 flex-shrink-0" style="font-size: 0.9em; line-height: 1.1;">
            {{ person_data.nome }} {% if person_data.is_user_selected %} <span class="badge bg-success" style="color: #212529 !important;">Você</span>{% endif %}
        </h5>
        
        <div class="details text-muted text-center flex-grow-1 d-flex flex-column justify-content-center w-100" style="font-size: 0.65em; line-height: 1.05;">
            {% if person_data.data_nascimento %}
                <small class="text-nowrap d-block">Nasc.: {{ person_data.data_nascimento|date:"d/m/Y" }}</small>
            {% endif %}
            <small class="text-nowrap d-block">Idade: {% if person_data.idade %}{{ person_data.idade }}{% else %}N/A{% endif %}</small>
            <small class="text-nowrap d-block">Gênero: {{ person_data.genero }}</small>
            <small class="text-nowrap d-block">Parentesco: <strong>{{ person_data.relacao }}</strong></small>
            <small class="text-nowrap d-block">Status: {{ person_data.status_vida }}</small>
            {% if person_data.local_nascimento %}
                <small class="text-nowrap d-block">Local Nasc.: {{ person_data.local_nascimento }}</small>
            {% endif %}
        </div>
        
        <button class="btn btn-sm btn-info mt-auto" data-bs-toggle="modal" data-bs-target="#personDetailsModal" data-person-id="{{ person_data.id }}" style="font-size: 0.7em; padding: 0.2em 0.5em;">
            Detalhes
        </button>
    </div>
</div>